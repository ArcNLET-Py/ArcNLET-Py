<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1-Groundwater Flow &mdash; ArcNLET-Py User&#39;s Manual December 20th, 2023 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=65185a0e" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=cdec1bd1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2-Particle Tracking" href="particletracking.html" />
    <link rel="prev" title="0-Preprocessing" href="preprocessing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ArcNLET-Py User's Manual
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">ArcNLET-Py: A Python Version of ArcGIS-Based Nitrogen Load Estimation Toolbox Developed for ArcGIS Pro</a></li>
<li class="toctree-l1"><a class="reference internal" href="simplifiedmodel.html">Simplified Model of Nitrogen Transformation and Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">0-Preprocessing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">1-Groundwater Flow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-layers">Input Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#options-and-parameters">Options and Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="particletracking.html">2-Particle Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="vzmod.html">3-VZMOD</a></li>
<li class="toctree-l1"><a class="reference internal" href="transport.html">4-Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="loadestimation.html">5-Load Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installationandrequirements.html">Installation and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparinginputdata.html">Preparing Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="lakeshoeexample.html">Lakeshore Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="usingpreprocessing.html">Using the Preprocessing Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="usinggroundwaterflow.html">Using the Groundwater Flow Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="usingparticletracking.html">Using the Particle Tracking Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="usingvzmod.html">Using the VZMOD Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="usingtransport.html">Using the Transport Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="usingloadestimation.html">Using the Load Estimation Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="sensitivityandcalibration.html">Sensitivity and Calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">REFERENCES</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ArcNLET-Py User's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">1-Groundwater Flow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/groundwaterflow.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="preprocessing.html" class="btn btn-neutral float-left" title="0-Preprocessing" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="particletracking.html" class="btn btn-neutral float-right" title="2-Particle Tracking" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="groundwater-flow">
<span id="groundwaterflow"></span><h1>1-Groundwater Flow<a class="headerlink" href="#groundwater-flow" title="Link to this heading"></a></h1>
<p>In traditional groundwater modeling, groundwater velocity is calculated
using Darcy’s Law. Darcy’s Law requires determining the hydraulic head
everywhere in the domain by solving a differential equation (heat
equation) given certain initial and boundary conditions. Once the
hydraulic head is known everywhere, the hydraulic gradient can be
calculated, and the flow velocities can be determined using Darcy’s Law.
Traditional tools are challenging to use and require field data that is
not usually readily available. The task is to devise a simplified
groundwater flow model that reduces data requirements and integrates
into ArcGIS Pro.</p>
<p>Obtaining field data for calculating the hydraulic head of the surficial
aquifer (either by solving a differential equation or by interpolation)
is complex and resource-intensive. The approach taken by this model is
to assume that the hydraulic head distribution of the surficial aquifer
(e.g., the water table) is a subdued replica of the topography. A
subdued replica means the shape of the water table can generally follow
the shape of the overlying topography. In other words, if the topography
has many peaks and dips, the water table is smoother and has fewer peaks
and dips. This assumption is widely used (either explicitly or
implicitly) in hydrological modeling. Topographic data is readily
available through digital elevation models (DEMs). By processing a DEM,
generating a subdued replica of the topography is possible, thereby
reducing traditional groundwater modeling data requirements.</p>
<p>It is necessary to make several approximations regarding the system to
use the processed DEM as a proxy for the water table. First, the system
is assumed to be in a steady state. This state means that the generated
water table should be considered an “average” over time. The Smoothing
Factor parameter value is the number of smoothings that the user inputs.
A larger number leads to a smoother DEM. A very large number (e.g.,
1,000) of Smoothing Factor leads to a flat smoothed DEM. The Groundwater
Flow Module also assumes that the Dupuit approximation is valid in the
surficial aquifer. Under the Dupuit conditions, vertical hydraulic
gradients can be ignored (i.e., flow is horizontal only, and simulating
two-dimensional flow is sufficient for three-dimensional domains), and
the hydraulic gradient is considered equal to the slope of the water
table. Finally, flow is assumed to occur solely within the surficial
aquifer. In other words, unsaturated flow, flow to or from confined
aquifers, and the interactions between groundwater and surface water are
not considered. Additionally, recharge is also not considered.</p>
<p>The mandatory outputs of the Groundwater Flow Module (Figure 2‑2) are
two raster datasets representing the magnitude and direction components
of the groundwater flow velocity vector. The module has the optional
raster outputs for hydraulic gradient and the smoothed DEM. The smoothed
DEM raster can be used to calculate the depth from the bottom of the
OSTDS to the water table using the optional VZMOD Module.</p>
<p>For a new ArcNLET-Py modeling, the Groundwater Flow Module is the first
module that needs to be run. All other modules in the ArcNLET-Py toolbox
depend on the groundwater velocity for their calculations. If
groundwater velocity does not change in a new execution, there is no
need to rerun this module. This module uses a DEM to approximate the
hydraulic gradient, which is then combined with aquifer properties to
calculate groundwater seepage velocity. Inputting the DEM and aquifer
properties is described below.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="_images/image1.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image1.png" style="width: 4.57356in; height: 6.02167in;" /></a>
<figcaption>
<p><span class="caption-text">Figure 2‑2: The Groundwater Flow Module in the Geoprocessing Pane.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="input-layers">
<h2>Input Layers<a class="headerlink" href="#input-layers" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Input DEM [L] (raster):</strong> Used to generate an approximation of the
water table. This input must be a raster layer (preferably in GRID
format). Note that a higher resolution DEM does not necessarily give
better results since a coarser DEM may better approximate the water
table (Wolock and Price, 1994). This DEM is the base for all
processing in this module.</p></li>
<li><p><strong>Input Water bodies (polygon):</strong> Must be a polygon-type layer. This
dataset determines the locations of water bodies to which groundwater
flows. This input is also used when the <strong>Fill Sinks</strong> option is
selected.</p></li>
<li><p><strong>Input Hydraulic conductivity [L/T] (raster):</strong> Must be a raster
layer. This input represents a map of hydraulic conductivity for the
domain. The linear units of the hydraulic conductivity must be the
same as the units of the DEM. For example, if the DEM has linear
(ground distance) units of meters, the hydraulic conductivity must
have units of meters per unit of time. The output seepage velocity
magnitude has the same units as the input, i.e., L/T (length over
time). It is the user’s responsibility to ensure that all units are
consistent.</p></li>
<li><p><strong>Input Soil porosity (raster):</strong> It must be a raster layer. This
input represents a map of soil porosity for the domain, and the soil
porosity is used to calculate groundwater seepage velocity.</p></li>
</ul>
</section>
<section id="options-and-parameters">
<h2>Options and Parameters<a class="headerlink" href="#options-and-parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Smoothing Factor:</strong> This controls the number of smoothing
iterations performed on the DEM to generate a subdued replica of the
topography. Higher numbers mean more smoothing and, thus, a flatter
replica. As the number of iterations increases, the difference in the
output from one iteration to the next becomes smaller and smaller.
Values typically range between 20 and 100 depending on the specific
application area. The optimum value may be determined by comparing
the smoothed DEM with hydraulic head observations. The default value
is 20.</p></li>
<li><p><strong>Smoothing Cell:</strong> This is the window size or neighborhood for
smoothing the DEM. An odd number is recommended. The default value is
7, meaning that in a smoothing calculation, the center of the window
in the DEM becomes the average of all the pixels in the 7-by-7
neighborhood around it.</p></li>
<li><p><strong>Fill Sinks:</strong> Enables or turns off sink-filling. It is helpful to
enable sink-filling when the presence of sinks or pits in the DEM
causes flowlines (generated by the Particle Tracking Module, see
Section 2.3) to become trapped before they reach a water body. More details
about filling sinks are available at
<a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/how-fill-works.htm">https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/how-fill-works.htm</a>.
Generally speaking, leaving sink-filling disabled (the default of
ArcNLET-Py) can be advantageous, even if some pits remain after
smoothing, but only if the pits do not interfere with the flow lines. As
part of the sink-filling functionality, areas in the smoothed input DEM
that are overlain by a water body are superimposed onto the sink-filled
DEM, thereby preserving low-elevation areas in large water bodies
(smaller water bodies are likely smoothed away). This superposition of
the smoothed, unfilled DEM in areas where water bodies are present can
be helpful in limited circumstances where sink-filling has caused the
cells of the smoothed DEM immediately bordering a water body to flow in
unnatural directions.</p></li>
<li><p><strong>Merge Water bodies:</strong> During the smoothing
process, the elevation at water bodies always increases, and this
artificially decreases the control of water bodies on groundwater flow,
given that groundwater discharges to the water bodies. One solution is
to merge the original DEM where the water bodies are located with the
smoothed DEM, and this restores the control of water bodies on
groundwater flow. The merging may be done several times until reasonable
groundwater flow paths are obtained in the Particle Tracking
Module.</p></li>
<li><p><strong>Z-Factor:</strong> If the horizontal measurement units of the input
DEM are different than the vertical units, the Z-factor value serves as
a conversion factor to convert the vertical unit into the horizontal
unit, which is necessary for slope calculations. For example, if the
horizontal units are meters and the vertical units are feet, the
z-factor is 0.3048 since one-foot equals 0.3048 meters. If the units are
the same, this value should be left at the default 1. Note that the
<strong>Z-Factor</strong> cannot be used to convert between two different horizontal
measurement units.</p></li>
</ul>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Velocity Magnitude [L/T]:</strong> Each cell in this raster represents the
magnitude of the seepage velocity in the same units as the hydraulic
conductivity. The output format is a GRID raster.</p></li>
<li><p><strong>Output Velocity Direction [°wrt N]:</strong> Each cell in this raster
represents the direction component of the seepage velocity
in degrees clockwise from the grid north. The output format is a GRID
raster.</p></li>
<li><p><strong>(Optional) Output Hydraulic Gradient:</strong> If named, it enables the
output of the raster of hydraulic gradient magnitude. The
output format is a GRID raster. This
output is for informational purposes only (e.g., for examining the
gradient values) and is not required in the other modules.</p></li>
<li><p><strong>(Optional) Output Smoothed DEM:</strong> The smoothed DEM represents
the subdued replica of the topology provided by the input DEM.
This DEM represents the shape of groundwater. This DEM does not
represent the elevation of the
groundwater. The smoothed DEM can be used as a data input in the VZMOD
module.</p></li>
</ul>
<p>Notes:</p>
<ul class="simple">
<li><p>Inputs from geodatabases are not supported at this time. All datasets
must be shapefile-based.</p></li>
<li><p>The input raster images (DEM elevation,
hydraulic conductivity, and porosity) should ideally have the same
spatial extent. Otherwise, the output raster of velocity magnitude has
the extent of the smallest input raster. The direction raster has the
same extent as the input DEM.</p></li>
<li><p>It is recommended for the input raster datasets to have square cells
since inaccuracies may be introduced in the calculations if the
cells are rectangular. The user should ensure that the sizes of the
cells are the same for all raster datasets.</p></li>
<li><p>Units must be consistent. For example, if the values of hydraulic
conductivity are in meters per day, the input DEM should also be in
units of meters.</p></li>
</ul>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<p>Table 2‑2 lists two possible issues encountered during model execution,
their possible causes, and suggested solutions. Note that the error
messages may appear for reasons other than those listed. If you cannot
find a solution to the issue, you can submit a [New issue] in the
ArcNLET-Py GitHub repository (<a class="reference external" href="https://github.com/ArcNLET-Py/ArcNLET-Py/issues">Issues · ArcNLET-Py/ArcNLET-Py ·
GitHub</a>) as
described in the GitHub instructions at <a class="reference external" href="https://docs.github.com/en/issues/tracking-your-work-with-issues/creating-an-issue">Creating an issue - GitHub
Docs</a>.</p>
<p>Table 2‑2: The Groundwater Flow Module troubleshooting guide.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Error</strong></p></th>
<th class="head"><p><strong>Cause</strong></p></th>
<th class="head"><p><strong>Solution</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Raster image outputs
have a solid black
fill with only null
or no-data values.</p></td>
<td><p>There might have
been an error
processing the
data inputs.</p></td>
<td><p>Ensure all your
data inputs are
correct, in an
accessible file
folder, and are
uncorrupted.</p></td>
</tr>
<tr class="row-odd"><td><p>Empty output
datasets.</p></td>
<td><p>An issue with
the input data,
an error in the
file names, or
ArcGIS Pro not
having
read/write
access to input
or output file
locations.</p></td>
<td><p>Ensure all your
data
inputs/outputs
are correct, in
an accessible
file folder, and
are uncorrupted.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="preprocessing.html" class="btn btn-neutral float-left" title="0-Preprocessing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="particletracking.html" class="btn btn-neutral float-right" title="2-Particle Tracking" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Michael Core, Wei Mao, and Ming Ye.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>